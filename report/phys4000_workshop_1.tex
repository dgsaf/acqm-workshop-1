\documentclass[]{article}

% - Style
\usepackage{base}

% - Plotting
\usepackage{pgfplotstable}
\usepgfplotslibrary{units}
\usetikzlibrary{external}
\tikzexternalize[mode=list and make]

% - Listings
\usepackage{color}
\usepackage{listings}

\lstset{
  basicstyle=\ttfamily\footnotesize\color{black}
  , commentstyle=\color{blue}
  , keywordstyle=\color{purple}
  , stringstyle=\color{orange}
  %
  , numbers=left
  , numbersep=5pt
  , stepnumber=1
  , numberstyle=\ttfamily\small\color{black}
  %
  , keepspaces=true
  , showspaces=false
  , showstringspaces=false
  , showtabs=false
  , tabsize=2
  , breaklines=true
  %
  , frame=single
  , backgroundcolor=\color{white}
  , rulecolor=\color{black}
  , captionpos=b
  %
  , language=Fortran
}

% file or folder
\lstdefinestyle{ff}{
  basicstyle=\ttfamily\normalsize\color{orange}
}

% - Title
\title{PHYS4000 - Workshop 1}
\author{Tom Ross - 1834 2884}
\date{}

% - Headers
\pagestyle{fancy}
\fancyhf{}
\rhead{\theauthor}
\chead{}
\lhead{\thetitle}
\rfoot{\thepage}
\cfoot{}
\lfoot{}

% - Document
\begin{document}

\section{Introduction}
\label{sec:introduction}

We consider the one-electron Hydrogenic-atom Hamiltonian, which is of the form
\begin{equation*}
  \hat{H}
  \ket{\psi}
  =
  E
  \ket{\psi}
\end{equation*}
where $\hat{H} = \hat{K} + \hat{V}$, with
\begin{equation*}
  \hat{K}
  \ket{\psi}
  =
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac{1}{2 r^{2}}
    \hat{L}^{2}
  }
  \ket{\psi}
  \qq{and}
  \hat{V}
  \ket{\psi}
  =
  -
  \dfrac{Z}{r}
  \ket{\psi}
\end{equation*}
and where $\hat{L} = \hat{L}_{x} + \hat{L}_{y} + \hat{L}_{z}$ is the angular
momentum operator, which has eigenstates $\ket{Y_{\ell}^{m}}$ which satisfy
\begin{equation*}
  \hat{L}^{2}
  \ket{Y_{\ell}^{m}}
  =
  \ell
  \lr{\ell + 1}
  \ket{Y_{\ell}^{m}}
  \qq{and}
  \hat{L}_{z}
  \ket{Y_{\ell}^{m}}
  =
  m
  \ket{Y_{\ell}^{m}}
  .
\end{equation*}
We solve this system by the method of basis expansion, where we utilise a basis
of the form, $\mathcal{B} = \lrset{\ket{\phi_{i}}}_{i = 1}^{N}$ which we suppose
to be complete in the limit as $N \to \infty$.
We select the basis functions, represented in coordinate-space, to be of the
form
\begin{equation*}
  \phi_{i}\lr{r, \Omega}
  =
  \dfrac{1}{r}
  \varphi_{k_{i}, \ell_{i}}\lr{r}
  Y_{\ell_{i}}^{m_{i}}\lr{\Omega}
  \qq{for}
  i = 1, \dotsc, N
\end{equation*}
where the radial functions,
$\mathcal{R} = \lrset{\ket{\varphi_{k_{i}, \ell_{i}}}}_{i = 1}^{N}$ form a
complete basis for the radial function space, in the limit as $N \to \infty$.
For elements of this basis, the one-electron Hydrogenic-atom Hamiltonian assumes
the form
\begin{alignat*}{2}
  \hat{H}
  \ket{\phi_{i}}
  {}={}
  &
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac{1}{2 r^{2}}
    \hat{L}^{2}
    -
    \dfrac{Z}{r}
  }
  \ket{\phi_{i}}
  \\
  {}={}
  &
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac
    {
      \ell_{i}
      \lr{\ell_{i} + 1}
    }
    {
      2
      r^{2}
    }
    -
    \dfrac{Z}{r}
  }
  \ket{\phi_{i}}
  \\
  {}={}
  &
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac
    {
      \ell_{i}
      \lr{\ell_{i} + 1}
    }
    {
      2
      r^{2}
    }
    -
    \dfrac{Z}{r}
  }
  \ket
  {
    \tfrac{1}{r}\varphi_{k_{i}, \ell_{i}}
    ,
    Y_{\ell_{i}}^{m_{i}}
  }
\end{alignat*}
thus reducing to operator which acts purely to radial terms, indexed by
$\ell_{i}$.
Lastly, we note that the inner product is of the form
\begin{equation*}
  \bra{\phi_{i}}
  \hat{A}
  \ket{\phi_{j}}
  =
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \int_{\Omega}
    \dd{\Omega}
    {
      \overline
      {
        \phi_{i}\lr{r, \Omega}
      }
      \hat{A}
      \lrsq[\big]
      {
        \phi_{j}\lr{r, \Omega}
      }
    }
  }
\end{equation*}
where $\hat{A}$ is an arbitrary linear operator, and whence, in the case where
$\hat{A}$ can be reduced to an operator which acts only on radial terms, indexed
by $\ell$, we have that
\begin{alignat*}{2}
  \bra{\phi_{i}}
  \hat{A}
  \ket{\phi_{j}}
  {}={}
  &
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \overline
    {
      \tfrac{1}{r}
      \varphi_{k_{i}, \ell_{i}}\lr{r}
    }
    \hat{A}_{\ell_{j}}
    \lrsq[\big]
    {
      \tfrac{1}{r}
      \varphi_{k_{j}, \ell_{j}}\lr{r}
    }
  }
  \int_{\Omega}
  \dd{\Omega}
  {
    \overline
    {
      Y_{\ell_{i}}^{m_{i}}\lr{\Omega}
    }
    Y_{\ell_{j}}^{m_{j}}\lr{\Omega}
  }
  \\
  {}={}
  &
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \overline
    {
      \tfrac{1}{r}
      \varphi_{k_{i}, \ell_{i}}\lr{r}
    }
    \hat{A}_{\ell_{j}}
    \lrsq[\big]
    {
      \tfrac{1}{r}
      \varphi_{k_{j}, \ell_{j}}\lr{r}
    }
  }
  \delta_{\ell_{i}, \ell_{j}}
  \delta_{m_{i}, m_{j}}
  \\
  {}={}
  &
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell_{i}}}
  \hat{A}_{\ell_{j}}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell_{j}}}
  \delta_{\ell_{i}, \ell_{j}}
  \delta_{m_{i}, m_{j}}
\end{alignat*}
where we have defined the radial inner product to be of the form
\begin{equation*}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell_{i}}}
  \hat{A}_{\ell_{j}}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell_{j}}}
  =
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \overline
    {
      \tfrac{1}{r}
      \varphi_{k_{i}, \ell_{i}}\lr{r}
    }
    \hat{A}_{\ell_{j}}
    \lrsq[\big]
    {
      \tfrac{1}{r}
      \varphi_{k_{j}, \ell_{j}}\lr{r}
    }
  }
  .
\end{equation*}
We solve the system by the method of basis expansion, which is to say that we
expand the pseudostates, $\lrset{\ket{\Phi_{i}}}_{i = 1}^{N}$ of $\hat{H}$ in
terms of the basis $\mathcal{B}$, as
\begin{equation*}
  \ket{\Phi_{i}}
  =
  \sum_{j = 1}^{N}
  C_{i, j}
  \ket{\phi_{j}}
\end{equation*}
which, in the limit as $N \to \infty$, satisfy, for $k = 1, \dotsc, N$,
\begin{equation*}
  \hat{H}
  \ket{\Phi_{k}}
  =
  E_{k}
  \ket{\Phi_{k}}
  .
\end{equation*}
Whence, for $k = 1, \dotsc, N$, we have that
\begin{alignat*}{2}
  \bra{\phi_{i}}
  \hat{H}
  \ket{\Phi_{k}}
  {}={}
  &
  E_{k}
  \bra{\phi_{i}}
  \ket{\Phi_{k}}
  \\
  \sum_{j = 1}^{N}
  C_{k, j}
  \bra{\phi_{i}}
  \hat{H}
  \ket{\phi_{j}}
  {}={}
  &
  E_{k}
  \sum_{j = 1}^{N}
  C_{k, j}
  \bra{\phi_{i}}
  \ket{\phi_{k}}
  \\
  \sum_{j = 1}^{N}
  C_{k, j}
  \lr
  {
    \bra{\phi_{i}}
    \hat{H}
    \ket{\phi_{j}}
    -
    E_{k}
    \bra{\phi_{i}}
    \ket{\phi_{k}}
  }
  {}={}
  &
  0
  \\
  \sum_{j = 1}^{N}
  C_{k, j}
  \lr
  {
    H_{i, j}
    -
    E_{k}
    B_{i, j}
  }
  {}={}
  &
  0
\end{alignat*}
yielding a set of generalised eigenvalue problems.
Lastly, due to the Hamiltonian being reducible for given $\ell$, $m$, we
introduce the notation that
\begin{equation*}
  \ket{\Phi_{k, \ell, m}}
  =
  \sum_{i = 1}^{N}
  C_{k, i}^{(\ell, m)}
  \ket{\phi_{i, \ell, m}}
\end{equation*}
as well as the radial functions of the pseudostates
\begin{equation*}
  \ket{\overline{\Phi}_{k, \ell, m}}
  =
  \sum_{i = 1}^{N}
  C_{k, i}^{(\ell, m)}
  \ket{\varphi_{i, \ell, m}}
  .
\end{equation*}

\clearpage
\section{Laguerre Basis}
\label{sec:laguerre-basis}

We utilise a Laguerre basis for the set of radial functions which,
for $k = 1, 2, \dotsc$ and where $\ell \in \lrset{0, 1, \dotsc}$, are of the
following form in coordinate-space
\begin{equation*}
  \varphi_{k, \ell}\lr{r}
  =
  N_{k, \ell}
  \lr
  {
    2
    \alpha_{\ell}
    r
  }^{\ell + 1}
  \exponential\lr
  {
    -
    \alpha_{\ell}
    r
  }
  L_{k - 1}^{2 \ell + 1}\lr{2 \alpha_{\ell} r}
\end{equation*}
where $\alpha_{\ell} \in (0, \infty)$ is an arbitrarily chosen constant,
where $N_{k, \ell}$ are the normalisation constants, given by
\begin{equation*}
  N_{k, \ell}
  =
  \sqrt
  {
    \dfrac
    {
      \alpha_{\ell}
      \lr{k - 1}!
    }
    {
      \lr{k + \ell}
      \lr{k + 2 \ell}!
    }
  }
\end{equation*}
and where $L_{k - 1}^{2 \ell + 1}$ are the generalised Laguerre polynomials.

\subsection{Recurrence Relation}
\label{sec:recurrence-relation}

We construct the Laguerre basis by means of the following recurrence relation of
the Laguerre polynomials
\begin{alignat*}{2}
  L_{0}^{t}\lr{x}
  {}={}
  &
  1
  \\
  L_{1}^{t}\lr{x}
  {}={}
  &
  1
  +
  t
  -
  x
  \\
  \lr{n + 1}
  L_{n + 1}^{t}\lr{x}
  {}={}
  &
  \lr
  {
    2
    n
    +
    1
    +
    t
    -
    x
  }
  L_{n}^{t}\lr{x}
  -
  \lr{n + t}
  L_{n - 1}^{t}\lr{x}
  \qq{for}
  n = 1, 2, \dotsc.
\end{alignat*}
Firstly, we write
$\varphi_{k, \ell}\lr{r} = N_{k, \ell}\widetilde{\varphi}_{k, \ell}\lr{r}$,
whence we note that
\begin{alignat*}{2}
  \widetilde{\varphi}_{1, \ell}\lr{r}
  {}={}
  &
  \lr
  {
    2
    \alpha_{\ell}
    r
  }^{\ell + 1}
  \exponential\lr
  {
    -
    \alpha_{\ell}
    r
  }
  \\
  \widetilde{\varphi}_{2, \ell}\lr{r}
  {}={}
  &
  2
  \lr
  {
    \ell
    +
    1
    -
    \alpha_{\ell}
    r
  }
  \lr
  {
    2
    \alpha_{\ell}
    r
  }^{\ell + 1}
  \exponential\lr
  {
    -
    \alpha_{\ell}
    r
  }
  \\
  \lr{k - 1}
  \widetilde{\varphi}_{k, \ell}\lr{r}
  {}={}
  &
  2
  \lr
  {
    k
    -
    1
    +
    \ell
    -
    \alpha_{\ell}
    r
  }
  \widetilde{\varphi}_{k - 1, \ell}\lr{r}
  -
  \lr
  {
    k
    +
    2
    \ell
    -
    1
  }
  \widetilde{\varphi}_{k - 2, \ell}\lr{r}
  \qq{for}
  k = 3, 4, \dotsc,
\end{alignat*}
from which can trivially recover the functions $\varphi_{k, \ell}\lr{r}$.

\subsection{Normalisation Constant Recurrence Relation}
\label{sec:norm-const}

To circumvent overflow errors when calculating the normalisation constant,
$N_{k, \ell}$, we construct these constants using a recurrence relations.
We note that
\begin{alignat*}{2}
  N_{k, \ell}
  {}={}
  &
  \sqrt
  {
    \dfrac
    {
      \alpha_{\ell}
      \lr{k - 1}!
    }
    {
      \lr{k + \ell}
      \lr{k + 2\ell}!
    }
  }
  \\
  {}={}
  &
  \sqrt
  {
    \dfrac
    {
      \lr{k - 1}
      \lr{k - 1 + \ell}
    }
    {
      \lr{k + \ell}
      \lr{k + 2\ell}
    }
    \dfrac
    {
      \alpha_{\ell}
      \lr{k - 2}!
    }
    {
      \lr{k - 1 + \ell}
      \lr{k + 2\ell - 1}!
    }
  }
  \\
  {}={}
  &
  \sqrt
  {
    \dfrac
    {
      \lr{k - 1}
      \lr{k - 1 + \ell}
    }
    {
      \lr{k + \ell}
      \lr{k + 2\ell}
    }
  }
  N_{k - 1, \ell}
\end{alignat*}
for $k = 2, 3, \dotsc$ and where $\ell \in \lrset{0, 1, \dotsc}$, and that
\begin{equation*}
  N_{1, \ell}
  =
  \sqrt
  {
    \dfrac
    {
      \alpha_{\ell}
    }
    {
      \lr{\ell + 1}
      \lr{2\ell + 1}!
    }
  }
\end{equation*}
yielding a numerically-stable recurrence relation for the normalisation
constants as required.

\subsection{Laguerre Radial Basis Code}
\label{sec:lagu-radi-basis-code}

FORTRAN code for calculating the Laguerre basis functions for a given radial
grid can be found in
\lstinline[style=ff]{src/laguerre.f90: }\lstinline{subroutine radial_basis()},
and is shown in \autoref{lst:laguerre_radial_basis}.

\lstinputlisting[
linerange={7-75}
, firstnumber=7
, caption={Calculation of Laguerre radial basis functions for a given radial
  grid.}
, label={lst:laguerre_radial_basis}
]{../src/laguerre.f90}

% figures: (4) different combinations of l, alpha, showing first (4) basis
% functions

\subsection{Laguerre Radial Basis Figures}
\label{sec:lagu-radi-basis-figs}

A radial grid has been constructed, for given $\mathrm{d_{r}}$ and
$\mathrm{r_{max}}$, of the form
\begin{equation*}
  \lrset
  {
    r_{i}
    =
    \mathrm{d_{r}}
    \cdot
    \lr{i - 1}
  }_{i = 1}^{\mathrm{n_{r}}}
\end{equation*}
where $\mathrm{n_{r}}$ is the smallest integer such that
\begin{equation*}
  \mathrm{d_r}
  \cdot
  \lr {\mathrm{n_r} - 1}
  \geq
  \mathrm{r_{max}}
  .
\end{equation*}
The Laguerre basis functions have been calculated on this radial grid,
for various values of $\ell$ and $\alpha_{\ell}$.
The plots of the first 4 basis functions for these values of $\ell$ and
$\alpha_{\ell}$ are shown in \autoref{fig:laguerre}.

\begin{figure}[h]
  \centering
  \begin{subfigure}[b]{0.45\linewidth}
    \begin{tikzpicture}
      \begin{axis}[
        , scale = 0.75
        , title = {[$\ell = 0$, $\alpha_{\ell} = 1.0$]}
        , xlabel = {Radial Distance}
        , ylabel = {}
        , x unit = {a_{0}}
        , y unit = {}
        , grid = major
        , legend entries
        , legend style = {
          cells = {anchor=east}
          , legend pos = north east
          , font = \tiny
        }
        , xmin = 0
        , xmax = 20
        , ymin = -0.75
        , ymax = 0.75
        ]

        \pgfplotsforeachungrouped \n in {1, ..., 4} {
          \pgfmathtruncatemacro{\i}{100.0*real(\n - 1)/real(4 - 1)}
          \edef\temp{\noexpand%
            \addplot [
            color = red!\i!black
            ] table [y index = \n]
            {../output/l-0.m-0.alpha-1.0000.atomic_charge-1.n_basis-4/basis.txt};
          }\temp
          \addlegendentryexpanded{$\varphi_{\n, 0}\lr{r}$}
        }

      \end{axis}
    \end{tikzpicture}
    \caption
    {
      $\varphi_{k, 0}\lr{r}$ for $k = 1, 2, 3, 4$, with $\alpha_{\ell} = 1.0$.
    }
    \label{fig:laguerre-0-1.0}
  \end{subfigure}
  %
  \begin{subfigure}[b]{0.45\linewidth}
    \begin{tikzpicture}
      \begin{axis}[
        scale = 0.75
        , title = {[$\ell = 1$, $\alpha_{\ell} = 1.0$]}
        , xlabel = {Radial Distance}
        , ylabel = {}
        , x unit = {a_{0}}
        , y unit = {}
        , grid = major
        , legend entries
        , legend style = {
          cells = {anchor=east}
          , legend pos = north east
          , font = \tiny
        }
        , xmin = 0
        , xmax = 20
        , ymin = -0.75
        , ymax = 0.75
        ]

        \pgfplotsforeachungrouped \n in {1, ..., 4} {
          \pgfmathtruncatemacro{\i}{100.0*real(\n - 1)/real(4 - 1)}
          \edef\temp{\noexpand%
            \addplot [
            color = red!\i!black
            ] table [y index = \n]
            {../output/l-1.m-0.alpha-1.0000.atomic_charge-1.n_basis-4/basis.txt};
          }\temp
          \addlegendentryexpanded{$\varphi_{\n, 1}\lr{r}$}
        }

      \end{axis}
    \end{tikzpicture}
    \caption
    {
      $\varphi_{k, 1}\lr{r}$ for $k = 1, 2, 3, 4$, with $\alpha_{\ell} = 1.0$.
    }
    \label{fig:laguerre-0-1.0}
  \end{subfigure}

  \begin{subfigure}[b]{0.45\linewidth}
    \begin{tikzpicture}
      \begin{axis}[
        , scale = 0.75
        , title = {[$\ell = 0$, $\alpha_{\ell} = 0.5$]}
        , xlabel = {Radial Distance}
        , ylabel = {}
        , x unit = {a_{0}}
        , y unit = {}
        , grid = major
        , legend entries
        , legend style = {
          cells = {anchor=east}
          , legend pos = north east
          , font = \tiny
        }
        , xmin = 0
        , xmax = 30
        , ymin = -0.75
        , ymax = 0.75
        ]

        \pgfplotsforeachungrouped \n in {1, ..., 4} {
          \pgfmathtruncatemacro{\i}{100.0*real(\n - 1)/real(4 - 1)}
          \edef\temp{\noexpand%
            \addplot [
            color = red!\i!black
            ] table [y index = \n]
            {../output/l-0.m-0.alpha-0.5000.atomic_charge-1.n_basis-4/basis.txt};
          }\temp
          \addlegendentryexpanded{$\varphi_{\n, 0}\lr{r}$}
        }

      \end{axis}
    \end{tikzpicture}
    \caption
    {
      $\varphi_{k, 0}\lr{r}$ for $k = 1, 2, 3, 4$, with $\alpha_{\ell} = 0.5$.
    }
    \label{fig:laguerre-0-0.5}
  \end{subfigure}
  %
  \begin{subfigure}[b]{0.45\linewidth}
    \begin{tikzpicture}
      \begin{axis}[
        , scale = 0.75
        , title = {[$\ell = 1$, $\alpha_{\ell} = 0.5$]}
        , xlabel = {Radial Distance}
        , ylabel = {}
        , x unit = {a_{0}}
        , y unit = {}
        , grid = major
        , legend entries
        , legend style = {
          cells = {anchor=east}
          , legend pos = north east
          , font = \tiny
        }
        , xmin = 0
        , xmax = 30
        , ymin = -0.75
        , ymax = 0.75
        ]

        \pgfplotsforeachungrouped \n in {1, ..., 4} {
          \pgfmathtruncatemacro{\i}{100.0*real(\n - 1)/real(4 - 1)}
          \edef\temp{\noexpand%
            \addplot [
            color = red!\i!black
            ] table [y index = \n]
            {../output/l-1.m-0.alpha-0.5000.atomic_charge-1.n_basis-4/basis.txt};
          }\temp
          \addlegendentryexpanded{$\varphi_{\n, 1}\lr{r}$}
        }

      \end{axis}
    \end{tikzpicture}
    \caption
    {
      $\varphi_{k, 1}\lr{r}$ for $k = 1, 2, 3, 4$, with $\alpha_{\ell} = 0.5$.
    }
    \label{fig:laguerre-1-0.5}
  \end{subfigure}

  \caption{
    The first four Laguerre radial basis functions are plotted for various cases
    of $\ell$ and $\alpha_{\ell}$.
    Note that every figure has the same y-axes bounds $\lrsq{-0.75, 0.75}$,
    whereas the x-axes bounds are $\lrsq{0, 20}$ for the $\alpha_{\ell} = 1.0$ cases,
    and $\lrset{0, 30}$ for the $\alpha_{\ell} = 0.5$ cases.
    Observe that $\varphi_{k, \ell}\lr{r}$ has $k$ extremal points, with
    each extrema being larger (in magnitude) than the preceeding extrema, before
    eventually exhibiting exponential decay to 0, after the last extremal point.
  }
  \label{fig:laguerre}
\end{figure}

It can be seen from \autoref{fig:laguerre} that as $\ell$ increases, the
Laguerre radial functions are somewhat shifted further from the origin;
that is, they are suppressed at the origin, peak at a further distance away from
the origin, and extend further away from the origin before exponentially
decaying to 0.
They also have wider and less pronounced peaks.

It can also be seen from \autoref{fig:laguerre} that as $\alpha_{\ell}$
decreases, the Laguerre radial basis functions extend much further away from the
origin before exponentially decaying to 0, and have wider and less pronounced
peaks.

\clearpage
\section{Kinetic Energy Matrix Elements}
\label{sec:kinet-energy-matr}

Here, we shall derive an analytic expression for the kinetic energy matrix
elements, with regard to the Laguerre radial basis.
Firstly, we note that the kinetic energy matrix elements are defined by
\begin{equation*}
  K_{i, j}
  =
  \bra{\phi_{i}}
  \hat{K}
  \ket{\phi_{j}}
  =
  \bra{\phi_{i}}
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac{1}{2 r^{2}}
    \hat{L}^{2}
  }
  \ket{\phi_{j}}
\end{equation*}
whence we note that
\begin{alignat*}{2}
  K_{i, j}
  {}={}
  &
  \bra
  {
    \tfrac{1}{r}\varphi_{k_{i}, \ell_{i}}
    ,
    Y_{\ell_{i}}^{m_{i}}
  }
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac{1}{2 r^{2}}
    \hat{L}^{2}
  }
  \ket
  {
    \tfrac{1}{r}\varphi_{k_{j}, \ell_{j}}
    ,
    Y_{\ell_{j}}^{m_{j}}
  }
  \\
  {}={}
  &
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell_{i}}}
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \dv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac
    {
      \ell_{j}
      \lr{\ell_{j} + 1}
    }
    {
      2
      r^{2}
    }
  }
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell_{j}}}
  \bra{Y_{\ell_{i}}^{m_{i}}}
  \ket{Y_{\ell_{j}}^{m_{j}}}
  \\
  {}={}
  &
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell_{i}}}
  \hat{K}_{\ell_{j}}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell_{j}}}
  \delta_{\ell_{i}, \ell_{j}}
  \delta_{m_{i}, m_{j}}
  .
\end{alignat*}
We note that since the matrix element is necessarily zero, where
$\ell_{i} \neq \ell_{j}$, we restrict our attention to the case where
$\ell_{i} = \ell_{j} = \ell$.
It follows that the radial terms can be written in the form
\begin{alignat*}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \hat{K}_{\ell}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  {}={}
  &
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \dv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac
    {
      \ell
      \lr{\ell + 1}
    }
    {
      2
      r^{2}
    }
  }
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  \\
  {}={}
  &
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \overline
    {
      \tfrac{1}{r}
      \varphi_{k_{i}, \ell}\lr{r}
    }
    \lrsq[\bigg]
    {
      -
      \dfrac{1}{2 r}
      \dv[2]{r}
      \lr[\big]
      {
        r
        \cdot
      }
      +
      \dfrac
      {
        \ell
        \lr{\ell + 1}
      }
      {
        2
        r^{2}
      }
    }
    \lr[\big]
    {
      \tfrac{1}{r}
      \varphi_{k_{j}, \ell}\lr{r}
    }
  }
  \\
  {}={}
  &
  \int_{0}^{\infty}
  \dd{r}
  {
    \varphi_{k_{i}, \ell}\lr{r}
    \lrsq[\bigg]
    {
      -
      \dfrac{1}{2}
      \dv[2]{r}
      +
      \dfrac
      {
        \ell
        \lr{\ell + 1}
      }
      {
        2
        r^{2}
      }
    }
    \varphi_{k_{j}, \ell}\lr{r}
  }
\end{alignat*}
where we have dropped the conjugacy due to the Laguerre radial basis functions
being entirely real-valued.
Expanding this fully, we have that
\begin{alignat*}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \hat{K}_{\ell}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  {}={}
  &
  \int_{0}^{\infty}
  \dd{r}
  % {
  \lr[\big]
  {
    N_{k_{i}, \ell}
    \lr
    {
      2
      \alpha
      r
    }^{\ell + 1}
    \exponential\lr
    {
      -
      \alpha
      r
    }
    L_{k_{i} - 1}^{2 \ell + 1}\lr{2 \alpha r}
  }
  \\
  &
  {}\times{}
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2}
    \dv[2]{r}
    +
    \dfrac
    {
      \ell
      \lr{\ell + 1}
    }
    {
      2
      r^{2}
    }
  }
  \lr[\big]
  {
    N_{k_{j}, \ell}
    \lr
    {
      2
      \alpha
      r
    }^{\ell + 1}
    \exponential\lr
    {
      -
      \alpha
      r
    }
    L_{k_{j} - 1}^{2 \ell + 1}\lr{2 \alpha r}
  }
\end{alignat*}
whence we introduce the variable transformation $x = 2 \alpha r$, to yield an
equivalent integral of the form
\begin{alignat*}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \hat{K}_{\ell}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  {}={}
  &
  \lr{2 \alpha}
  N_{k_{i}, \ell}
  N_{k_{j}, \ell}
  \int_{0}^{\infty}
  \dd{x}
  x^{\ell + 1}
  \exponential\lr{-\tfrac{x}{2}}
  L_{k_{i} - 1}^{2 \ell + 1}\lr{x}
  \\
  &
  {}\times{}
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2}
    \dv[2]{x}
    +
    \dfrac
    {
      \ell
      \lr{\ell + 1}
    }
    {
      2
      x^{2}
    }
  }
  \lr[\big]
  {
    x^{\ell + 1}
    \exponential\lr{-\tfrac{x}{2}}
    L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
  }
  .
\end{alignat*}
At this point, we note that
\begin{alignat*}{2}
  \dv[2]{x}
  \lr[\big]
  {
    &
    x^{\ell + 1}
    \exponential\lr{-\tfrac{x}{2}}
    L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
  }
  {}={}
  x^{\ell + 1}
  \exponential\lr{-\tfrac{x}{2}}
  \\
  &
  {}\times{}
  \lr[\Bigg]
  {
    \lr[\bigg]
    {
      \dfrac
      {
        \ell
        \lr{\ell + 1}
      }
      {
        x^{2}
      }
      -
      \dfrac
      {
        \ell + 1
      }
      {
        x
      }
      +
      \dfrac{1}{4}
    }
    L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
    +
    \lr[\bigg]
    {
      \dfrac
      {
        2
        \lr{\ell + 1}
      }
      {
        x
      }
      -
      1
    }
    \dv{x}
    \lr[\big]
    {
      L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
    }
    +
    \dv[2]{x}
    \lr[\big]
    {
      L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
    }
  }
\end{alignat*}
whence
\begin{alignat*}{2}
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2}
    \dv[2]{x}
    +
    \dfrac
    {
      \ell
      \lr{\ell + 1}
    }
    {
      2
      x^{2}
    }
  }
  \lr[\big]
  {
    &
    x^{\ell + 1}
    \exponential\lr{-\tfrac{x}{2}}
    L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
  }
  {}={}
  -
  \dfrac{1}{2}
  x^{\ell + 1}
  \exponential\lr{-\tfrac{x}{2}}
  \\
  &
  {}\times{}
  \lr[\Bigg]
  {
    \lr[\bigg]
    {
      -
      \dfrac
      {
        \ell + 1
      }
      {
        x
      }
      +
      \dfrac{1}{4}
    }
    L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
    +
    \lr[\bigg]
    {
      \dfrac
      {
        2
        \lr{\ell + 1}
      }
      {
        x
      }
      -
      1
    }
    \dv{x}
    \lr[\big]
    {
      L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
    }
    +
    \dv[2]{x}
    \lr[\big]
    {
      L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
    }
  }
  .
\end{alignat*}
We utilise the following recurrence relation of the generalised Laguerre
polynomials,
\begin{equation*}
  \dfrac{t + 1 - x}{x}
  \dv{x}
  \lr[\big]
  {
    L_{n}^{t}\lr{x}
  }
  +
  \dv[2]{x}
  \lr[\big]
  {
    L_{n}^{t}\lr{x}
  }
  =
  -
  \dfrac{n}{x}
  L_{n}^{t}\lr{x}
\end{equation*}
to further simplify the above term to the form
\begin{equation*}
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2}
    \dv[2]{x}
    +
    \dfrac
    {
      \ell
      \lr{\ell + 1}
    }
    {
      2
      x^{2}
    }
  }
  \lr[\big]
  {
    x^{\ell + 1}
    \exponential\lr{-\tfrac{x}{2}}
    L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
  }
  =
  \dfrac{1}{2}
  \lr[\bigg]
  {
    \dfrac
    {
      k_{j}
      +
      \ell
    }
    {
      x
    }
    -
    \dfrac{1}{4}
  }
  x^{\ell + 1}
  \exponential\lr{-\tfrac{x}{2}}
  L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
\end{equation*}
whence the integral becomes
\begin{equation*}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \hat{K}_{\ell}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  =
  \alpha
  N_{k_{i}, \ell}
  N_{k_{j}, \ell}
  \int_{0}^{\infty}
  \dd{x}
  \lr[\bigg]
  {
    k_{j}
    +
    \ell
    -
    \dfrac{x}{4}
  }
  x^{2\ell + 1}
  \exponential\lr{-x}
  L_{k_{i} - 1}^{2 \ell + 1}\lr{x}
  L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
\end{equation*}
We note that
\begin{equation*}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  =
  \dfrac
  {
    N_{k_{i}, \ell}
    N_{k_{j}, \ell}
  }
  {
    2
    \alpha
  }
  \int_{0}^{\infty}
  \dd{x}
  {
    x^{2\ell + 2}
    \exponential\lr{-x}
    L_{k_{i} - 1}^{2\ell + 1}\lr{x}
    L_{k_{j} - 1}^{2\ell + 1}\lr{x}
  }
\end{equation*}
whence the previous integral can be separated as
\begin{alignat*}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \hat{K}_{\ell}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  {}={}
  &
  \alpha
  N_{k_{i}, \ell}
  N_{k_{j}, \ell}
  \lr{k_{j} + \ell}
  \int_{0}^{\infty}
  \dd{x}
  x^{2\ell + 1}
  \exponential\lr{-x}
  L_{k_{i} - 1}^{2 \ell + 1}\lr{x}
  L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
  \\
  &
  {}-{}
  \dfrac{\alpha}{4}
  N_{k_{i}, \ell}
  N_{k_{j}, \ell}
  \int_{0}^{\infty}
  x^{2\ell + 2}
  \exponential\lr{-x}
  L_{k_{i} - 1}^{2 \ell + 1}\lr{x}
  L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
  \\
  {}={}
  &
  \alpha
  N_{k_{i}, \ell}
  N_{k_{j}, \ell}
  \lr{k_{j} + \ell}
  \int_{0}^{\infty}
  \dd{x}
  x^{2\ell + 1}
  \exponential\lr{-x}
  L_{k_{i} - 1}^{2 \ell + 1}\lr{x}
  L_{k_{j} - 1}^{2 \ell + 1}\lr{x}
  \\
  &
  {}-{}
  \dfrac{\alpha^{2}}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  .
\end{alignat*}
At this point we note the following property of the generalised Laguerre
polynomials,
\begin{equation*}
  \int_{0}^{\infty}
  \dd{x}
  x^{t}
  \exponential\lr{-x}
  L_{n}^{t}\lr{x}
  L_{m}^{t}\lr{x}
  =
  \dfrac
  {
    \lr{n + t}!
  }
  {
    n!
  }
  \delta_{m, n}
\end{equation*}
whence the radial term of the kinetic energy matrix elements is shown to be
given analytically by the expression
\begin{alignat*}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \hat{K}_{\ell}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  {}={}
  &
  \alpha
  N_{k_{i}, \ell}^{2}
  \lr{k_{j} + \ell}
  \dfrac
  {
    \lr{k_{j} + 2\ell}!
  }
  {
    \lr{k_{j} - 1}!
  }
  \delta_{k_{i}, k_{j}}
  -
  \dfrac{\alpha^{2}}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  \\
  {}={}
  &
  \alpha^{2}
  \delta_{k_{i}, k_{j}}
  -
  \dfrac{\alpha^{2}}{2}
  \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
  \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  .
\end{alignat*}
It follows that the kinetic energy matrix elements are thus of the form
\begin{equation*}
  K_{i, j}
  =
  \alpha^{2}
  \lr[\Big]
  {
    \delta_{k_{i}, k_{j}}
    -
    \dfrac{1}{2}
    \bra{\tfrac{1}{r}\varphi_{k_{i}, \ell}}
    \ket{\tfrac{1}{r}\varphi_{k_{j}, \ell}}
  }
  \delta_{\ell_{i}, \ell_{j}}
  \delta_{m_{i}, m_{j}}
  .
\end{equation*}


\subsection{Extension: Overlap Matrix Elements}
\label{sec:extens-overl-matr}

% derive overlap energy matrix elements

\section{Atomic Hydrogen States}
\label{sec:atom-hydr-stat}

%

\subsection{Hydrogenic Atom Code}
\label{sec:hydrogenic-atom-code}

\subsubsection{Overlap Matrix Elements}
\label{sec:overl-matr-elem}

FORTRAN code for calculating the overlap matrix elements for a Laguerre radial
basis of a given dimension can be found in
\lstinline[style=ff]{src/laguerre.f90: }\lstinline{subroutine overlap_matrix()},
and is shown in \autoref{lst:laguerre_overlap}.

\lstinputlisting[
linerange={77-120}
, firstnumber=77
, caption={Calculation of overlap matrix elements for a Laguerre radial basis of
a given dimension.}
, label={lst:laguerre_overlap}
]{../src/laguerre.f90}

\subsubsection{Kinetic Energy Matrix Elements}
\label{sec:kinet-energy-matr-1}

FORTRAN code for calculating the kinetic energy matrix elements for a Laguerre
radial basis of a given dimension can be found in
\lstinline[style=ff]{src/laguerre.f90: }\lstinline{subroutine kinetic_matrix()},
and is shown in \autoref{lst:laguerre_kinetic}.

\lstinputlisting[
linerange={122-166}
, firstnumber=122
, caption={Calculation of kinetic energy matrix elements for a Laguerre radial
  basis of a given dimension.}
, label={lst:laguerre_kinetic}
]{../src/laguerre.f90}

\subsubsection{Coulomb Potential Matrix Elements}
\label{sec:coulomb-potential-matr}

FORTRAN code for calculating the Coulomb potential matrix elements for a
Laguerre radial basis of a given dimension can be found in
\lstinline[style=ff]{src/laguerre.f90: }\lstinline{subroutine coulomb_matrix()},
and is shown in \autoref{lst:laguerre_coulomb}.

\lstinputlisting[
linerange={168-204}
, firstnumber=168
, caption={Calculation of Coulomb potential matrix elements for a Laguerre
  radial basis of a given dimension.}
, label={lst:laguerre_coulomb}
]{../src/laguerre.f90}

\subsubsection{Hamiltonian Matrix Elements}
\label{sec:hamilt-matr-elem}

FORTRAN code for calculating the overlap, kinetic energy, potential energy, and
Hamiltonian matrix elements for a Laguerre radial basis of a given dimension can
be found in
\lstinline[style=ff]{src/laguerre.f90: }\lstinline{subroutine hydrogenic_matrices()},
and is shown in \autoref{lst:laguerre_hydrogenic}.

\lstinputlisting[
linerange={206-244}
, firstnumber=206
, caption={Calculation of overlap, kinetic energy, potential energy, and
  Hamiltonian matrix elements for a Laguerre radial basis of a given dimension.}
, label={lst:laguerre_hydrogenic}
]{../src/laguerre.f90}

\subsubsection{Hydrogenic Atom Program}
\label{sec:hydr-atom-progr}

A FORTRAN program which calculates the pseudo-energies and pseudo-states of a
one-electron Hydrogenic-atom Hamiltonian by the method of basis expansion,
using the Laguerre radial basis, for given
$(\ell, m, \alpha_{\ell}, Z, \mathrm{n_{basis}}, \mathrm{d_{r}},
\mathrm{r_{max}})$, can be found in
\lstinline[style=ff]{src/hydrogenic_atom.f90}
and is shown in \autoref{lst:hydrogenic_atom}.

\lstinputlisting[
, caption={Calculation of pseudo-energies and pseudo-states of a one-electron
  Hydrogenic-atom Hamiltonian by the method of basis expansion, using the
  Laguerre radial basis.}
, label={lst:hydrogenic_atom}
]{../src/hydrogenic_atom.f90}

\subsection{Hydrogen Energy Spectrum Figures}
\label{sec:hydr-atom-progr-1}

% figure: for l = 0 alpha = 1.0, and varying n_basis, the convergence of the
% eigenvalues to the hydrogen energy spectrum

The bound energy spectrum of a one-electron Hydrogen atom, calculated for
$l = 0$, $\alpha = 1.0$, and for varying
$\mathrm{n_{basis}} = 2^{0}, \dotsc,  2^{7}$ is shown in
\autoref{fig:energy-spectrum-varying-n_basis}.
It is compared with the analytical energies, which are known to be
\begin{equation*}
  E_{n}
  =
  -
  \dfrac{1}{2 n^{2}}
  \qq{for}
  n = 1, 2, \dotsc
\end{equation*}
in atomic units.
Note that all pseudo-energies greater than 0, obtained by diagonalising the
Hamiltonian matrix, are not presented in
\autoref{fig:energy-spectrum-varying-n_basis}.

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      , scale = 1.5
      , title = {Bound Energy Spectrum for [$\ell = 0$, $\alpha_{\ell} = 1.0$]
        with varying $\mathrm{n_{basis}}$}
      , xlabel = {$\mathrm{n_{basis}}$}
      , ylabel = {Energy}
      , x unit = {}
      , y unit = {\si{\hartree}}
      , xmin = 0.5
      , ymin = -0.55
      , ymax = 0.0
      , restrict y to domain=-0.55:0.0
      , xmode = log
      , log basis x = {2}
      , grid = minor
      , legend entries
      , legend style = {
        cells = {anchor=east}
        , legend pos = north east
        , font = \tiny
      }
      , xtick={1, 2, 4, 8, 16, 32, 64, 128}
      , xticklabels={1, 2, 4, 8, 16, 32, 64, 128}
      , extra x ticks = {512}
      , extra x tick labels={Analytical}
      ]
      \pgfmathsetmacro{\w}{0.4}

      \foreach \n in {1, 2, 4, 8, 16, 32, 64, 128}{
        \pgfplotstableread[header=false, col sep=space, row sep=newline]
        {../output/l-0.m-0.alpha-1.0000.atomic_charge-1.n_basis-\n/eigen_values.txt}
        {\data}

        \pgfplotstableforeachcolumnelement{[index]0}\of\data\as\energy{%
          \addplot [black, mark=none] coordinates {
            (\n*2^(-\w), \energy)
            (\n*2^(+\w), \energy)
          };
        }

        \pgfplotstableclear{\data}
      }

      \foreach \k in {1, ..., 50}{
        \pgfmathsetmacro{\energy}{-0.5 / (\k ^ 2)}
        \addplot [black, thick, mark=none] coordinates {
          (512.0*2^(-\w), \energy)
          (512.0*2^(+\w), \energy)
        };
      }
    \end{axis}
  \end{tikzpicture}
  \caption{Bound energy spectrums, in units of \si{\hartree}, for a one-electron
    Hydrogen atom, where $\ell = 0$, $\alpha_{\ell} = 1.0$, and where
    $\mathrm{n_{basis}} = 2^{0}, \dotsc, 2^{7}$.
    It is compared with the analytical energies.}
  \label{fig:energy-spectrum-varying-n_basis}
\end{figure}

It can be seen the bound energy spectrums do indeed converge to the analytical
bound energies, as $\mathrm{n_{basis}}$ increases.
It can also be seen that by approximately $\mathrm{n_{basis}} = 128$, that the
bound energy spectrum is sufficiently dense as to approximate the analytical
energy spectrum to a reasonable level.

% figure: for fixed n_basis and varying alpha, the behaviour of the eigenvalue
% spectrum, and the consequences it could have on subsequent scattering
% calculations

The bound energy spectrum of a one-electron Hydrogen atom, calculated for
$l = 0$, $\mathrm{n_{basis}} = 64$, and for varying
$\alpha_{\ell} = 0.50, 0.75, \dotsc, 1.50$, is shown in
\autoref{fig:energy-spectrum-varying-alpha}.
It is compared with the analytical energies, which are known to be
\begin{equation*}
  E_{n}
  =
  -
  \dfrac{1}{2 n^{2}}
  \qq{for}
  n = 1, 2, \dotsc
\end{equation*}
in atomic units.
Note that all pseudo-energies greater than 0, obtained by diagonalising the
Hamiltonian matrix, are not presented in
\autoref{fig:energy-spectrum-varying-alpha}.
Note also that the basis size is identical for each calculation, but the number
of bound pseudo-energies is not necessarily identical.

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      , scale = 1.5
      , title = {Bound Energy Spectrum for [$\ell = 0$,
        $\mathrm{n_{basis}} = 64$] with varying $\alpha_{\ell}$}
      , xlabel = {$\alpha_{\ell}$}
      , ylabel = {Energy}
      , x unit = {}
      , y unit = {\si{\hartree}}
      , xmin = 0.3
      , xmax = 2.2
      , ymin = -0.55
      , ymax = 0.0
      , restrict y to domain=-0.55:0.0
      , grid = minor
      , legend entries
      , legend style = {
        cells = {anchor=east}
        , legend pos = north east
        , font = \tiny
      }
      , xtick={0.50, 0.75, 1.00, 1.25, 1.50}
      , xticklabels={0.50, 0.75, 1.00, 1.25, 1.50}
      , extra x ticks={2.0}
      , extra x tick labels={Analytical}
      ]
      \pgfmathsetmacro{\w}{0.10}

      \foreach \a in {0.5000, 0.7500, 1.0000, 1.2500, 1.5000}{
        \pgfplotstableread[header=false, col sep=space, row sep=newline]
        {../output/l-0.m-0.alpha-\a.atomic_charge-1.n_basis-64/eigen_values.txt}
        {\data}

        \pgfplotstableforeachcolumnelement{[index]0}\of\data\as\energy{%
          \addplot [black, mark=none] coordinates {
            (\a - \w), \energy)
            (\a + \w), \energy)
          };
        }

        \pgfplotstableclear{\data}
      }

      \foreach \k in {1, ..., 50}{
        \pgfmathsetmacro{\energy}{-0.5 / (\k ^ 2)}
        \addplot [black, thick, mark=none] coordinates {
          (2.0 - \w, \energy)
          (2.0 + \w), \energy)
        };
      }
    \end{axis}
  \end{tikzpicture}
  \caption{Bound energy spectrums, in units of \si{\hartree}, for a one-electron
    Hydrogen atom, where $\ell = 0$, $\mathrm{n_{basis}} = 64$, and where
    $\alpha = 0.50, 0.75, \dotsc, 1.50$.
    It is compared with the analytical energies, represented at the label
    $\mathrm{n_{basis}} = \infty$.}
  \label{fig:energy-spectrum-varying-alpha}
\end{figure}

It can be seen that as $\alpha_{\ell}$ decreases, the bound energy spectrum
becomes increasingly dense, and thus, it can be inferred that the continuum
energy spectrum becomes increasingly sparse (since the total number of
psuedo-states, across bound and continuum states, is identical for each
calculation).
Conversely, as $\alpha_{\ell}$ increases, the bound energy spectrum becomes
increasingly sparse, while the continuum energy spectrum becomes increasingly
dense.

An implication of this observation is that for scattering calculations, if a
radial basis with a small value of $\alpha_{\ell}$ is utilised for the target
states, then the discretisation of the continuum energy spectrum might be
insufficient to model long-range interactions between the target electron and
the projectile.
That is, over-emphasising short-range or long-range structure, by using either a
small or large value for $\alpha_{\ell}$ may lead to inaccurate scattering
calculations.

% figures: for a satisfactory converged n_basis, a figure each for l = 0, l = 1,
% comparing the first (3) bound states with analytical solutions

We observe that for $\mathrm{n_{basis}} = 128$, the calculation is sufficiently
convergent to analytical solutions of the one-electron Hydrogen atom.
We present, for $\alpha_{\ell} = 1.0$ and $\mathrm{n_{basis}} = 128$, the first
three bound-state calculated radial functions, for the cases of $\ell = 0, 1$ in
\autoref{fig:bound-states}.

\begin{figure}[h]
  \centering
  \begin{subfigure}[b]{0.45\linewidth}
    \begin{tikzpicture}
      \begin{axis}[
        , scale = 0.75
        , title = {[$\ell = 0$]}
        , xlabel = {Radial Distance}
        , ylabel = {}
        , x unit = {a_{0}}
        , y unit = {}
        , grid = major
        , legend entries
        , legend style = {
          cells = {anchor=east}
          , legend pos = north east
          , font = \tiny
        }
        , xmin = 0
        , xmax = 20
        , ymin = -1.0
        , ymax = 1.0
        ]

        \pgfplotsforeachungrouped \n in {1, ..., 3} {
          \pgfmathtruncatemacro{\i}{100.0*real(\n - 1)/real(3 - 1)}
          \edef\temp{\noexpand%
            \addplot [
            color = red!\i!black
            ] table [y index = \n]
            {../output/l-0.m-0.alpha-1.0000.atomic_charge-1.n_basis-128/eigen_basis.txt};
          }\temp
          \addlegendentryexpanded{$\overline{\Phi}_{\n, 0}\lr{r}$}
        }

      \end{axis}
    \end{tikzpicture}
    \caption
    {
      $\overline{\Phi}_{k, 0}\lr{r}$ for $k = 1, 2, 3$, with
      $\alpha_{\ell} = 1.0$, $\mathrm{n_{basis}} = 128$.
    }
    \label{fig:bound-states-0}
  \end{subfigure}


  \caption{...}
    % The first four Laguerre radial basis functions are plotted for various cases
    % of $\ell$ and $\alpha_{\ell}$.
    % Note that every figure has the same y-axes bounds $\lrsq{-0.75, 0.75}$,
    % whereas the x-axes bounds are $\lrsq{0, 20}$ for the $\alpha_{\ell} = 1.0$ cases,
    % and $\lrset{0, 30}$ for the $\alpha_{\ell} = 0.5$ cases.
    % Observe that $\varphi_{k, \ell}\lr{r}$ has $k$ extremal points, with
    % each extrema being larger (in magnitude) than the preceeding extrema, before
    % eventually exhibiting exponential decay to 0, after the last extremal point.
  % }
  \label{fig:bound-states}
\end{figure}

\subsection{Extension: $\mathrm{He}^{+}$ Ion}
\label{sec:extens-he+-ion}

% can you reproduce its analytical energies and wave functions?

\subsection{Extension: Surface Plot in $xz$ Plane}
\label{sec:extens-surface-plot-xz}

% figure: surface plot, for m = 0, in xz plane

\subsection{Extension: Numerically Calculating Potential Matrix Elements}
\label{sec:extens-numer-calc-potent}

% evaluate v matrix elements numerically, discuss how to avoid singularity at
% origin

\end{document}