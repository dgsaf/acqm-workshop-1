\documentclass[]{article}

% - Style
\usepackage{base}

% - Plotting
\usepgfplotslibrary{units}

% - Listings
\usepackage{color}
\usepackage{listings}

\lstset{
  basicstyle=\ttfamily\footnotesize\color{black}
  , commentstyle=\color{blue}
  , keywordstyle=\color{purple}
  , stringstyle=\color{orange}
  %
  , numbers=left
  , numbersep=5pt
  , stepnumber=1
  , numberstyle=\ttfamily\small\color{black}
  %
  , keepspaces=true
  , showspaces=false
  , showstringspaces=false
  , showtabs=false
  , tabsize=2
  , breaklines=true
  %
  , frame=single
  , backgroundcolor=\color{white}
  , rulecolor=\color{black}
  , captionpos=b
  %
  , language=Fortran
}

% file or folder
\lstdefinestyle{ff}{
  basicstyle=\ttfamily\normalsize\color{orange}
}

% - Title
\title{PHYS4000 - Workshop 1}
\author{Tom Ross - 1834 2884}
\date{}

% - Headers
\pagestyle{fancy}
\fancyhf{}
\rhead{\theauthor}
\chead{}
\lhead{\thetitle}
\rfoot{\thepage}
\cfoot{}
\lfoot{}

% - Document
\begin{document}

\section{Introduction}
\label{sec:introduction}

We consider the one-electron Hydrogenic-atom Hamiltonian, which is of the form
\begin{equation*}
  \hat{H}
  \ket{\psi}
  =
  E
  \ket{\psi}
\end{equation*}
where $\hat{H} = \hat{K} + \hat{V}$, with
\begin{equation*}
  \hat{K}
  \ket{\psi}
  =
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac{1}{2 r^{2}}
    \hat{L}^{2}
  }
  \ket{\psi}
  \qq{and}
  \hat{V}
  \ket{\psi}
  =
  -
  \dfrac{Z}{r}
  \ket{\psi}
\end{equation*}
and where $\hat{L} = \hat{L}_{x} + \hat{L}_{y} + \hat{L}_{z}$ is the angular
momentum operator, which has eigenstates $\ket{Y_{\ell}^{m}}$ which satisfy
\begin{equation*}
  \hat{L}^{2}
  \ket{Y_{\ell}^{m}}
  =
  \ell
  \lr{\ell + 1}
  \ket{Y_{\ell}^{m}}
  \qq{and}
  \hat{L}_{z}
  \ket{Y_{\ell}^{m}}
  =
  m
  \ket{Y_{\ell}^{m}}
  .
\end{equation*}
We solve this system by the method of basis expansion, where we utilise a basis
of the form, $\mathcal{B} = \lrset{\ket{\phi_{i}}}_{i = 1}^{N}$ which we suppose
to be complete in the limit as $N \to \infty$.
We select the basis functions, represented in coordinate-space, to be of the
form
\begin{equation*}
  \phi_{i}\lr{r, \Omega}
  =
  \dfrac{1}{r}
  \varphi_{k_{i}, \ell_{i}}\lr{r}
  Y_{\ell_{i}}^{m_{i}}\lr{\Omega}
  \qq{for}
  i = 1, \dotsc, N
\end{equation*}
where the radial functions,
$\mathcal{R} = \lrset{\ket{\varphi_{k_{i}, \ell_{i}}}}_{i = 1}^{N}$ form a
complete basis for the radial function space, in the limit as $N \to \infty$.
For elements of this basis, the one-electron Hydrogenic-atom Hamiltonian assumes
the form
\begin{alignat*}{2}
  \hat{H}
  \ket{\phi_{i}}
  {}={}
  &
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac{1}{2 r^{2}}
    \hat{L}^{2}
    -
    \dfrac{Z}{r}
  }
  \ket{\phi_{i}}
  \\
  {}={}
  &
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac
    {
      \ell_{i}
      \lr{\ell_{i} + 1}
    }
    {
      2
      r^{2}
    }
    -
    \dfrac{Z}{r}
  }
  \ket{\phi_{i}}
  \\
  {}={}
  &
  \lrsq[\bigg]
  {
    -
    \dfrac{1}{2 r}
    \pdv[2]{r}
    \lr[\big]
    {
      r
      \cdot
    }
    +
    \dfrac
    {
      \ell_{i}
      \lr{\ell_{i} + 1}
    }
    {
      2
      r^{2}
    }
    -
    \dfrac{Z}{r}
  }
  \ket{\tfrac{1}{r}\varphi_{k_{i}, \ell_{i}}}
  \otimes
  \ket{Y_{\ell_{i}}^{m_{i}}}
\end{alignat*}
thus reducing to operator which acts purely to radial terms, indexed by
$\ell_{i}$.
Lastly, we note that the inner product is of the form
\begin{equation*}
  \bra{\phi_{i}}
  \hat{A}
  \ket{\phi_{j}}
  =
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \int_{\Omega}
    \dd{\Omega}
    {
      \overline
      {
        \phi_{i}\lr{r, \Omega}
      }
      \hat{A}
      \lrsq[\big]
      {
        \phi_{j}\lr{r, \Omega}
      }
    }
  }
\end{equation*}
where $\hat{A}$ is an arbitrary linear operator, and whence, in the case where
$\hat{A}$ can be reduced to an operator which acts only on radial terms, indexed
by $\ell$, we have that
\begin{alignat*}{2}
  \bra{\phi_{i}}
  \hat{A}
  \ket{\phi_{j}}
  {}={}
  &
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \overline
    {
      \tfrac{1}{r}
      \varphi_{k_{i}, \ell_{i}}\lr{r}
    }
    \hat{A}_{\ell_{j}}
    \lrsq[\big]
    {
      \tfrac{1}{r}
      \varphi_{k_{j}, \ell_{j}}\lr{r}
    }
  }
  \int_{\Omega}
  \dd{\Omega}
  {
    \overline
    {
      Y_{\ell_{i}}^{m_{i}}\lr{\Omega}
    }
    Y_{\ell_{j}}^{m_{j}}\lr{\Omega}
  }
  \\
  {}={}
  &
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \overline
    {
      \tfrac{1}{r}
      \varphi_{k_{i}, \ell_{i}}\lr{r}
    }
    \hat{A}_{\ell_{j}}
    \lrsq[\big]
    {
      \tfrac{1}{r}
      \varphi_{k_{j}, \ell_{j}}\lr{r}
    }
  }
  \delta_{\ell_{i}, \ell_{j}}
  \delta_{m_{i}, m_{j}}
  \\
  {}={}
  &
  \bra{\varphi_{k_{i}, \ell_{i}}}
  \hat{A}_{\ell_{j}}
  \ket{\varphi_{k_{j}, \ell_{j}}}
  \delta_{\ell_{i}, \ell_{j}}
  \delta_{m_{i}, m_{j}}
\end{alignat*}
where we have defined the radial inner product to be of the form
\begin{equation*}
  \bra{\varphi_{k_{i}, \ell_{i}}}
  \hat{A}_{\ell_{j}}
  \ket{\varphi_{k_{j}, \ell_{j}}}
  =
  \int_{0}^{\infty}
  \dd{r}
  {
    r^{2}
    \overline
    {
      \tfrac{1}{r}
      \varphi_{k_{i}, \ell_{i}}\lr{r}
    }
    \hat{A}_{\ell_{j}}
    \lrsq[\big]
    {
      \tfrac{1}{r}
      \varphi_{k_{j}, \ell_{j}}\lr{r}
    }
  }
  .
\end{equation*}

\section{Laguerre Basis}
\label{sec:laguerre-basis}

We utilise a Laguerre basis for the set of radial functions which,
for $k = 1, 2, \dotsc$ and where $\ell \in \lrset{0, 1, \dotsc}$, are of the
following form in coordinate-space
\begin{equation*}
  \varphi_{k, \ell}\lr{r}
  =
  N_{k, \ell}
  \lr
  {
    2
    \alpha
    r
  }^{\ell + 1}
  \exponential\lr
  {
    -
    \alpha
    r
  }
  L_{k - 1}^{2 \ell + 1}\lr{2 \alpha r}
\end{equation*}
where $\alpha \in (0, \infty)$ is an arbitrarily chosen constant,
where $N_{k, \ell}$ are the normalisation constants, given by
\begin{equation*}
  N_{k, \ell}
  =
  \sqrt
  {
    \dfrac
    {
      \alpha
      \lr{k - 1}!
    }
    {
      \lr{k + \ell}
      \lr{k + 2 \ell}!
    }
  }
\end{equation*}
and where $L_{k - 1}^{2 \ell + 1}$ are the generalised Laguerre polynomials.

\subsection{Recurrence Relation}
\label{sec:recurrence-relation}

We construct the Laguerre basis by means of the following recurrence relation of
the Laguerre polynomials
\begin{alignat*}{2}
  L_{0}^{t}\lr{x}
  {}={}
  &
  1
  \\
  L_{1}^{t}\lr{x}
  {}={}
  &
  1
  +
  t
  -
  x
  \\
  \lr{n + 1}
  L_{n + 1}^{t}\lr{x}
  {}={}
  &
  \lr
  {
    2
    n
    +
    1
    +
    t
    -
    x
  }
  L_{n}^{t}\lr{x}
  -
  \lr{n + t}
  L_{n - 1}^{t}\lr{x}
  \qq{for}
  n = 1, 2, \dotsc.
\end{alignat*}
Firstly, we write
$\varphi_{k, \ell}\lr{r} = N_{k, \ell}\widetilde{\varphi}_{k, \ell}\lr{r}$,
whence we note that
\begin{alignat*}{2}
  \widetilde{\varphi}_{1, \ell}\lr{r}
  {}={}
  &
  \lr
  {
    2
    \alpha
    r
  }^{\ell + 1}
  \exponential\lr
  {
    -
    \alpha
    r
  }
  \\
  \widetilde{\varphi}_{2, \ell}\lr{r}
  {}={}
  &
  2
  \lr
  {
    \ell
    +
    1
    -
    \alpha
    r
  }
  \lr
  {
    2
    \alpha
    r
  }^{\ell + 1}
  \exponential\lr
  {
    -
    \alpha
    r
  }
  \\
  \lr{k - 1}
  \widetilde{\varphi}_{k, \ell}\lr{r}
  {}={}
  &
  2
  \lr
  {
    k
    -
    1
    +
    \ell
    -
    \alpha
    r
  }
  \widetilde{\varphi}_{k - 1, \ell}\lr{r}
  -
  \lr
  {
    k
    +
    2
    \ell
    -
    1
  }
  \widetilde{\varphi}_{k - 2, \ell}\lr{r}
  \qq{for}
  k = 3, 4, \dotsc,
\end{alignat*}
from which can trivially recover the functions $\varphi_{k, \ell}\lr{r}$.

\subsection{Normalisation Constant Recurrence Relation}
\label{sec:norm-const}

To circumvent overflow errors when calculating the normalisation constant,
$N_{k, \ell}$, we construct these constants using a recurrence relations.
We note that
\begin{alignat*}{2}
  N_{k, \ell}
  {}={}
  &
  \sqrt
  {
    \dfrac
    {
      \alpha
      \lr{k - 1}!
    }
    {
      \lr{k + \ell}
      \lr{k + 2\ell}!
    }
  }
  \\
  {}={}
  &
  \sqrt
  {
    \dfrac
    {
      \lr{k - 1}
      \lr{k - 1 + \ell}
    }
    {
      \lr{k + \ell}
      \lr{k + 2\ell}
    }
    \dfrac
    {
      \alpha
      \lr{k - 2}!
    }
    {
      \lr{k - 1 + \ell}
      \lr{k + 2\ell - 1}!
    }
  }
  \\
  {}={}
  &
  \sqrt
  {
    \dfrac
    {
      \lr{k - 1}
      \lr{k - 1 + \ell}
    }
    {
      \lr{k + \ell}
      \lr{k + 2\ell}
    }
  }
  N_{k - 1, \ell}
\end{alignat*}
for $k = 2, 3, \dotsc$ and where $\ell \in \lrset{0, 1, \dotsc}$, and that
\begin{equation*}
  N_{1, \ell}
  =
  \sqrt
  {
    \dfrac
    {
      \alpha
    }
    {
      \lr{\ell + 1}
      \lr{2\ell + 1}!
    }
  }
\end{equation*}
yielding a numerically-stable recurrence relation for the normalisation
constants as required.

\subsection{Laguerre Radial Basis Code}
\label{sec:lagu-radi-basis-code}

FORTRAN code for calculating the Laguerre basis functions for a given radial
grid can be found in
\lstinline[style=ff]{src/laguerre.f90: }\lstinline{subroutine radial_basis()},
and is shown below

\lstinputlisting[
linerange={7-75}
, firstnumber=7
, caption={Calculation of Laguerre radial basis functions for a given radial
  grid.}
, label={lst:laguerre_radial_basis}
]{../src/laguerre.f90}

% figures: (4) different combinations of l, alpha, showing first (4) basis
% functions

\subsection{Laguerre Radial Basis Figures}
\label{sec:lagu-radi-basis-figs}

A radial grid has been constructed, for given $\mathrm{d_{r}}$ and
$\mathrm{r_{max}}$, of the form
\begin{equation*}
  \lrset
  {
    r_{i}
    =
    \mathrm{d_{r}}
    \cdot
    \lr{i - 1}
  }_{i = 1}^{\mathrm{n_{r}}}
\end{equation*}
where $\mathrm{n_{r}}$ is the smallest integer such that
\begin{equation*}
  \mathrm{d_r}
  \cdot
  \lr {\mathrm{n_r} - 1}
  \geq
  \mathrm{r_{max}}
  .
\end{equation*}
The Laguerre basis functions have been calculated on this radial grid,
for various $\ell$ and $\alpha$.
The first four functions have been plotted for the following cases:
\begin{itemize}
\item The case of $\ell = 0$, $\alpha = 1.0$ is shown in
  \autoref{fig:laguerre-0-1.0}.
\end{itemize}

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      , scale = 1.5
      , title = {Laguerre Radial Basis Functions [$\ell = 0$, $\alpha = 1.0$]}
      , xlabel = {Radial Distance}
      , ylabel = {}
      , x unit = {a_{0}}
      , y unit = {}
      , grid = major
      , legend entries
      , legend style = {
        cells = {anchor=east}
        , legend pos = north east
      }
      , xmin = 0
      , xmax = 20
      ]

      \pgfplotsforeachungrouped \n in {1, ..., 4} {
        \pgfmathtruncatemacro{\i}{100.0*real(\n - 1)/real(4 - 1)}
        \edef\temp{\noexpand%
        \addplot [
        color = red!\i!black
        ] table [y index = \n]
        {../output/l-0.m-0.alpha-1.0000.atomic_charge-1.n_basis-16/basis.txt};
        }\temp
        \addlegendentryexpanded{$\varphi_{\n, 0}\lr{r}$}
      }

    \end{axis}
  \end{tikzpicture}
  \caption{...}
  \label{fig:laguerre-0-1.0}
\end{figure}

%% discuss effect of changing l, alpha

%% choose appropriate r_max to show exponential decay

\section{Kinetic Energy Matrix Elements}
\label{sec:kinet-energy-matr}

% derive kinetic energy matrix elements

\subsection{Extension: Overlap Matrix Elements}
\label{sec:extens-overl-matr}

% derive overlap energy matrix elements

\section{Atomic Hydrogen States}
\label{sec:atom-hydr-stat}

% figure: for l = 0 alpha = 1.0, and varying n_basis, the convergence % of the
% eigenvalues to the hydrogen energy spectrum

% figure: for fixed n_basis and varying alpha, the behaviour of the eigenvalue
% spectrum, and the consequences it could have on subsequent scattering
% calculations

% figures: for a satisfactory converged n_basis, a figure each for l = 0, l = 1,
% comparing the first (3) bound states with analytical solutions

\subsection{Extension: $\mathrm{He}^{+}$ Ion}
\label{sec:extens-he+-ion}

% can you reproduce its analytical energies and wave functions?

\subsection{Extension: Surface Plot in $xz$ Plane}
\label{sec:extens-surface-plot-xz}

% figure: surface plot, for m = 0, in xz plane

\subsection{Extension: Numerically Calculating Potential Matrix Elements}
\label{sec:extens-numer-calc-potent}

% evaluate v matrix elements numerically, discuss how to avoid singularity at
% origin

\end{document}